---
title: "Final Project"
author: "Nicole Ham, Ruslana Korolov, Hanna Pan"
date: "`r Sys.Date()`"
output: github_document
---
```{r}
library(tidyverse)
library(dplyr)
```

```{r}
habits_df <- read_csv("student_habits_performance.csv")
social_df <- read_csv("smmh.csv")

habits_df <- habits_df %>%
  mutate(
    age = as.numeric(age),
    social_media_hours_binned = cut(
      social_media_hours,
      breaks = c(-Inf, 1, 2, 3, 4, Inf),
      labels = c("0-1 hours", "1-2 hours", "2-3 hours", "3-4 hours", "4+ hours"),
      right = TRUE),
    age_range = cut(
      age,
      breaks = c(-Inf, 17, 21, 25, Inf),
      labels = c("<18", "18-21", "22-25", "26+"),
      right = TRUE))

social_df_clean <- social_df %>%
  select(
    age = `1. What is your age?`,
    social_media_hours_raw = `8. What is the average time you spend on social media every day?`,
    depression_score = `18. How often do you feel depressed or down?`,
    sleep_issues_score = `20. On a scale of 1 to 5, how often do you face issues regarding sleep?`) %>%
  mutate(
    age = as.numeric(age),
    social_media_hours_raw = tolower(trimws(social_media_hours_raw)),
    social_media_hours_binned = case_when(
      str_detect(social_media_hours_raw, "0.*1") ~ "0-1 hours",
      str_detect(social_media_hours_raw, "1.*2") ~ "1-2 hours",
      str_detect(social_media_hours_raw, "2.*3") ~ "2-3 hours",
      str_detect(social_media_hours_raw, "3.*4") ~ "3-4 hours",
      str_detect(social_media_hours_raw, "4|5|more") ~ "4+ hours",
      TRUE ~ NA_character_
    ),
    age_range = case_when(
      age <= 17 ~ "<18",
      age <= 21 ~ "18-21",
      age <= 25 ~ "22-25",
      TRUE ~ "26+"
    )
  )

merged_df <- inner_join(
  habits_df %>% select(-gender),
  social_df_clean,
  by = c("social_media_hours_binned", "age_range"))

merged_df <- merged_df %>%
  select(-age.x, -age.y, -student_id, -social_media_hours_raw)

```

```{r}
head(merged_df)
```